@model IEnumerable<GuhaStore.Core.Entities.Product>
@{
    ViewData["Title"] = "Quản lý sản phẩm";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="admin-container">
    <!-- Header -->
    <div class="admin-header">
        <h1>Quản lý sản phẩm</h1>
        <a href="/Admin/CreateProduct" class="btn btn-primary">+ Thêm sản phẩm</a>
    </div>

    <!-- Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success">@TempData["SuccessMessage"]</div>
    }

    <!-- Products Table -->
    <div class="card">
        <div class="card-body" style="padding: 0; overflow-x: auto;">
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 8%;">ID</th>
                        <th style="width: 8%;">Hình</th>
                        <th style="width: 18%;">Tên</th>
                        <th style="width: 10%;">Giá</th>
                        <th style="width: 10%;">Giá KM</th>
                        <th style="width: 12%;">Danh mục</th>
                        <th style="width: 12%;">Thương hiệu</th>
                        <th style="width: 8%;">Kho</th>
                        <th style="width: 10%;">Trạng thái</th>
                        <th style="width: 12%;">Thao tác</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var p in Model)
                    {
                        <tr>
                            <td>@p.Id</td>
                            <td>
                                @{
                                    var img = string.IsNullOrEmpty(p.ImageUrl) ? Url.Content("~/images/img_1.png") : Url.Content(p.ImageUrl);
                                }
                                <img src="@img" alt="@p.Name" style="width:50px;height:50px;object-fit:cover;border-radius:4px;" />
                            </td>
                            <td style="max-width: 160px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">@p.Name</td>
                            <td>@p.Price.ToString("N0")₫</td>
                            <td>@(p.SalePrice.HasValue ? p.SalePrice.Value.ToString("N0") + "₫" : "-")</td>
                            <td>@(p.Category?.Name ?? "-")</td>
                            <td>@(p.Brand?.Name ?? "-")</td>
                            <td>@p.StockQuantity</td>
                            <td>
                                <span class="badge @(p.IsActive ? "bg-success" : "bg-secondary")">
                                    @(p.IsActive ? "Hoạt động" : "Tắt")
                                </span>
                            </td>
                            <td>
                                <a href="/Admin/EditProduct/@p.Id" class="btn" style="font-size: 0.85rem; padding: 6px 10px; background: var(--admin-accent); color: white; text-decoration: none; border-radius: 4px; display: inline-block;">Sửa</a>
                                <form asp-action="DeleteProduct" method="post" style="display: inline;">
                                    @Html.AntiForgeryToken()
                                    <input type="hidden" name="id" value="@p.Id" />
                                    <button type="submit" class="btn" style="font-size: 0.85rem; padding: 6px 10px; background: var(--admin-danger); color: white; border: none; border-radius: 4px; cursor: pointer;" onclick="return confirm('Bạn chắc chắn muốn xóa sản phẩm này?');">Xóa</button>
                                </form>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>


